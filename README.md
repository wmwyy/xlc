# 消力池计算器

 基于规范附录B.1的消力池在线计算工具

## 功能特性

-  **收缩水深计算**：基于能量方程求解
-  **跃后水深计算**：采用B.1.1-2完整公式，包含宽度修正系数
-  **消能计算**：水跃消能ΔE
-  **水跃长度**：水跃长度Lⱼ和护坦长度Lⱼ
-  **弗劳德数**：自动计算流态判断
-  **B.1.3 消力池底板厚度计算**：抗冲厚度和抗浮厚度计算
-  **B.2.1 海漫长度计算**：根据河床土质类型计算
-  **实时计算**：输入参数后即时获取结果
-  **美观界面**：现代化的 Web 界面
-  **多版本**：Streamlit Web版、tkinter桌面版、C# WPF版

## 在线访问

-  **Streamlit版**：部署后可用

## 本地部署

### 环境要求

- Python 3.8+
- pip

### 安装步骤

1. **克隆仓库**
\\\ash
git clone https://github.com/wmwyy/xlc.git
cd xlc
\\\

2. **安装依赖**
\\\ash
pip install -r requirements.txt
\\\

3. **运行 Streamlit Web 版**
\\\ash
streamlit run app.py
\\\

应用将在浏览器中自动打开，默认地址：http://localhost:8501

4. **运行桌面版**（可选）
\\\ash
python energy_basin.py
\\\

## 使用说明

### Streamlit Web 版

1. 访问应用网址或本地运行
2. 输入基本参数：
   - σ: 跃前淹没系数 (1.05~1.10)
   - α: 动能校正系数 (1.0~1.05)
   - q: 单宽流量 (m/s/m)
   - b, b: 首末槛宽度 (m)
3. 输入水力参数：
   - T: 总势能 (m)
   - p: 校正长度参数 (m)
   - h': 出池河床水深 (m)
   - L: 斜坡水平投影 (m)
   - β: 水跃长度校正 (0.7~0.8)
4. 点击"开始计算"
5. 查看详细结果和公式推导

## 计算公式

### 能量方程求解收缩水深

\\\
T = hc + αq/(2ghc)
\\\

通过求解三次方程得到收缩水深 hc。

### 跃后水深计算（B.1.1-2）

\\\
h''c = (hc/2)(√(1 + 8αq²/(ghc³)) - 1)(b₁/b₂)^0.25
\\\

其中：
- h''c: 跃后水深
- hc: 收缩断面水深
- α: 动能修正系数
- q: 单宽流量
- b₁, b₂: 首末槛宽度

### 消能计算

\\\
ΔE = (h''c - hc) / (4hch''c)
\\\

### 水跃长度

\\\
Lⱼ = β(4.5h''c + p)
\\\

### 护坦长度

\\\
Lⱼ = Lⱼ + L
\\\

### B.1.3 消力池底板厚度计算

**抗冲厚度（B.1.3-1）：**
\\\
t = k₁√(q√ΔH')
\\\

**抗浮厚度（B.1.3-2）：**
\\\
t = k₂(U - γhd ± Pm)/γb
\\\

其中：
- k₁: 消力池底板计算系数（0.15~0.20）
- k₂: 消力池底板安全系数（1.1~1.3）
- U: 作用在消力池底板底面的扬压力 (kPa)
- γ: 水的重力密度 (kN/m³)
- hd: 消力池内水深 (m)
- Pm: 作用在消力池底板上的脉动压力 (kPa)
- γb: 消力池底板的饱和容重 (kN/m³)

设计厚度取两者最大值，且不小于0.5m。消力池末端厚度可采用t/2，但不宜小于0.5m。

### B.2.1 海漫长度计算

\\\
Lp = Ks√(qs√ΔH')
\\\

其中：
- Lp: 海漫长度 (m)
- qs: 消力池末端单宽流量 (m³/(s·m))
- ΔH': 闸孔泄水时的上、下游水位差 (m)
- Ks: 海漫长度计算系数，由表B.2.1查得

**表 B.2.1 Ks值：**
| 河床土质 | Ks范围 |
|---------|--------|
| 粉砂、细砂 | 14~13 |
| 中砂、粗砂、粉质黏土 | 12~11 |
| 粉质黏土 | 10~9 |
| 坚硬黏土 | 8~7 |

**适用条件：**当√(qs√ΔH') = 1~9，且消能扩散良好时

## 计算示例

### 示例1：标准消力池
**输入参数：**
- σ = 1.05
- α = 1.00
- q = 5.0 m/s/m
- b = 10.0 m
- b = 12.0 m
- T = 8.0 m
- p = 1.0 m
- h' = 3.0 m
- L = 5.0 m
- β = 0.75
- g = 9.81 m/s

**计算结果：**
- hc  1.5~2.0 m（收缩水深）
- h''c  4.0~5.0 m（跃后水深）
- Frc  1.5~2.0（超临界流）
- Lⱼ  15~20 m（水跃长度）

## 技术栈

- **Python**: 3.8+
- **Web 框架**: Streamlit
- **数学计算**: math (标准库)
- **三次方程求解**: 自定义算法
- **桌面 GUI**: tkinter (energy_basin.py)
- **C# 版本**: .NET 8 + WPF (GateCalculator目录)

## Streamlit Cloud 部署

1. Fork 本仓库到你的 GitHub 账号
2. 访问 [Streamlit Cloud](https://share.streamlit.io/)
3. 使用 GitHub 账号登录
4. 点击 "New app"
5. 选择仓库、分支（main）和主文件（app.py）
6. 点击 "Deploy"

## 更新日志

### v1.1.0 (2025-12-30)
-  移除闸孔净宽计算模块
-  专注于消力池计算功能
-  优化青色主题UI
-  完整的LaTeX公式展示
-  修复计算精度问题

### v1.0.0 (2025-12-30)
-  新增 Streamlit Web 版本
-  消力池水力计算
-  保留tkinter和C#版本

## 物理意义说明

### 收缩水深 (hc)
闸门下游水流收缩后的最小水深，此处流速最大，动能最大。

### 跃后水深 (h''c)
水跃完成后的水深，流速减小，动能转化为势能和消散能量。

### 消能 (ΔE)
水跃过程中消散的能量，反映消力池的消能效果。

### 水跃长度 (Lⱼ)
从收缩断面到跃后断面的距离，决定了消力池的长度。

### 弗劳德数 (Frc)
表征流态的无量纲数：
- Frc > 1: 超临界流（急流）
- Frc = 1: 临界流
- Frc < 1: 亚临界流（缓流）

## 贡献

欢迎提交 Issue 和 Pull Request！

## 许可

MIT License

## 联系方式

- GitHub: [wmwyy/xlc](https://github.com/wmwyy/xlc)

---

 如果这个项目对你有帮助，请给个 Star！
